"use client"

import React, { useState, useEffect } from 'react';
import { io } from 'socket.io-client';
import Link from 'next/link';
// import { ArrowUpDown, Download } from 'lucide-react';
import Image from 'next/image';
import { LinkButton } from '@/components/elements';


const socket = io(process.env.NEXT_PUBLIC_SOCKET_URL || '');

function formatTime(time: number): string {
    const date = new Date(time);
    return date.toLocaleTimeString('en-US', {
        hour12: false,
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit',
        fractionalSecondDigits: 3
    });
}

function _calculateTimeDifference(startTime: number, endTime: number): string {
    const diff = endTime - startTime;
    const hours = Math.floor(diff / 3600000);
    const minutes = Math.floor((diff % 3600000) / 60000);
    const seconds = Math.floor((diff % 60000) / 1000);
    const milliseconds = diff % 1000;

    return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}.${milliseconds.toString().padStart(3, '0')}`;
}

export default function MainScreen() {
    const [question, setQuestion] = useState('');
    const [_players, setPlayers] = useState([]);
    const [answers, setAnswers] = useState([]);
    const [sortOrder, _setSortOrder] = useState('asc');

    useEffect(() => {
        const handleFullGameState = (gameState: { currentQuestion: React.SetStateAction<string>; players: React.SetStateAction<never[]>; answers: React.SetStateAction<never[]>; }) => {
            setQuestion(gameState.currentQuestion);
            setPlayers(gameState.players);
            setAnswers(gameState.answers);
        };

        socket.on('connect', () => {
            console.log('Connected to server');
            socket.emit('requestGameState');
        });

        socket.on('fullGameState', handleFullGameState);

        socket.on('playerJoined', (updatedPlayers) => {
            console.log('Player joined:', updatedPlayers);
            setPlayers(updatedPlayers);
        });

        socket.on('playerAnswered', (updatedAnswers) => {
            console.log('Player answered:', updatedAnswers);
            setAnswers(updatedAnswers);
        });

        socket.on('playerLeft', (updatedPlayers) => {
            console.log('Player left:', updatedPlayers);
            setPlayers(updatedPlayers);
        });

        socket.on('questionSelected', (selectedQuestion) => {
            console.log('Question selected:', selectedQuestion);
            setQuestion(selectedQuestion);
            setAnswers([]);
        });

        return () => {
            socket.off('connect');
            socket.off('fullGameState');
            socket.off('playerJoined');
            socket.off('playerAnswered');
            socket.off('playerLeft');
            socket.off('questionSelected');
        };
    }, []);

    const sortedAnswers = [...answers].sort((a, b) => {
        // eslint-disable-next-line @typescript-eslint/ban-ts-comment
        //@ts-ignore
        const timeA = a.time - answers[0].time;
        // eslint-disable-next-line @typescript-eslint/ban-ts-comment
        //@ts-ignore
        const timeB = b.time - answers[0].time;
        return sortOrder === 'asc' ? timeA - timeB : timeB - timeA;
    });

    // const toggleSortOrder = () => {
    //     setSortOrder(sortOrder === 'asc' ? 'desc' : 'asc');
    // };

    // const exportResults = () => {
    //     const csvContent = [
    //         ['Player Name', 'Response Time', 'Time Difference'],
    //         ...sortedAnswers.map(answer => [

    //             answer.playerName,
    //             formatTime(answer.time),
    //             calculateTimeDifference(answers[0].time, answer.time)
    //         ])
    //     ].map(row => row.join(',')).join('\n');

    //     const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
    //     const link = document.createElement('a');
    //     if (link.download !== undefined) {
    //         const url = URL.createObjectURL(blob);
    //         link.setAttribute('href', url);
    //         link.setAttribute('download', `game_results_${new Date().toISOString()}.csv`);
    //         link.style.visibility = 'hidden';
    //         document.body.appendChild(link);
    //         link.click();
    //         document.body.removeChild(link);
    //     }
    // };

    return (
        <div className="game_show_bg min-h-[100vh] p-8 md:px-[74px] md:py-[56px]">
            <div className='flex items-center justify-between gap-5 z-[999999]'>
                <div className='flex items-center gap-2'>
                    <Link href="#">

                        <Image
                            src={'/images/salary_for_life_small.png'}
                            alt=""
                            width="62"
                            height="46"
                            className="!w-[62.12px] !h-[46px]"
                        />

                    </Link>
                    <p className='text-[22px] font- max-w-[577px] text-white'>Game show</p>
                </div>

                <LinkButton variant='white' href="/QuestionsPage" className="px-4 py-2 !bg-white text-[#242424] whitespace-nowrap rounded">
                    Manage Questions
                </LinkButton>
            </div>
            <div className="container flex flex-col justify-center mt-4">
                <div className='flex justify-between gap-20 '>
                    <div className='basis-1/2'>
                        <svg width="617" height="273" viewBox="0 0 617 273" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <g opacity="0.5" filter="url(#filter0_f_12180_17983)">
                                <ellipse cx="308.5" cy="113" rx="194.5" ry="46" fill="#CF5BFF" />
                            </g>
                            <mask id="path-2-outside-1_12180_17983" maskUnits="userSpaceOnUse" x="220" y="87" width="177" height="51" fill="black">
                                <rect fill="white" x="220" y="87" width="177" height="51" />
                                <path d="M228.465 129V95.4H239.841C242.497 95.4 244.673 95.848 246.369 96.744C248.065 97.64 249.313 98.84 250.113 100.344C250.945 101.816 251.361 103.496 251.361 105.384C251.361 107.176 250.945 108.84 250.113 110.376C249.313 111.88 248.049 113.096 246.321 114.024C244.593 114.92 242.385 115.368 239.697 115.368H233.265V129H228.465ZM246.129 129L238.881 114.072H244.161L251.697 129H246.129ZM233.265 111.72H239.505C241.905 111.72 243.649 111.144 244.737 109.992C245.857 108.808 246.417 107.304 246.417 105.48C246.417 103.624 245.873 102.152 244.785 101.064C243.697 99.976 241.937 99.432 239.505 99.432H233.265V111.72ZM265.285 129.576C263.045 129.576 261.013 129.064 259.189 128.04C257.397 126.984 255.973 125.528 254.917 123.672C253.861 121.784 253.333 119.592 253.333 117.096C253.333 114.6 253.861 112.424 254.917 110.568C256.005 108.68 257.445 107.224 259.237 106.2C261.061 105.144 263.109 104.616 265.381 104.616C267.653 104.616 269.685 105.144 271.477 106.2C273.301 107.224 274.725 108.68 275.749 110.568C276.805 112.424 277.333 114.6 277.333 117.096C277.333 119.592 276.805 121.784 275.749 123.672C274.693 125.528 273.253 126.984 271.429 128.04C269.605 129.064 267.557 129.576 265.285 129.576ZM265.285 125.736C266.565 125.736 267.733 125.416 268.789 124.776C269.877 124.136 270.757 123.192 271.429 121.944C272.101 120.664 272.437 119.048 272.437 117.096C272.437 115.144 272.101 113.528 271.429 112.248C270.789 110.968 269.925 110.024 268.837 109.416C267.781 108.776 266.629 108.456 265.381 108.456C264.133 108.456 262.965 108.776 261.877 109.416C260.789 110.024 259.909 110.968 259.237 112.248C258.565 113.528 258.229 115.144 258.229 117.096C258.229 119.048 258.565 120.664 259.237 121.944C259.909 123.192 260.773 124.136 261.829 124.776C262.917 125.416 264.069 125.736 265.285 125.736ZM289.371 129.576C287.515 129.576 285.899 129.192 284.523 128.424C283.147 127.624 282.075 126.44 281.307 124.872C280.571 123.304 280.203 121.32 280.203 118.92V105.192H285.003V118.44C285.003 120.744 285.483 122.504 286.443 123.72C287.435 124.904 288.875 125.496 290.763 125.496C292.075 125.496 293.227 125.192 294.219 124.584C295.211 123.944 295.995 123.032 296.571 121.848C297.179 120.632 297.483 119.192 297.483 117.528V105.192H302.283V129H298.107L297.675 125.256H297.483C296.683 126.536 295.611 127.576 294.267 128.376C292.923 129.176 291.291 129.576 289.371 129.576ZM306.131 129V105.192H310.307L310.739 108.984H310.931C311.731 107.64 312.803 106.584 314.147 105.816C315.491 105.016 317.123 104.616 319.043 104.616C320.899 104.616 322.515 105.016 323.891 105.816C325.267 106.584 326.323 107.752 327.059 109.32C327.827 110.888 328.211 112.872 328.211 115.272V129H323.411V115.752C323.411 113.448 322.915 111.704 321.923 110.52C320.963 109.304 319.523 108.696 317.603 108.696C316.323 108.696 315.171 109.016 314.147 109.656C313.155 110.264 312.371 111.16 311.795 112.344C311.219 113.528 310.931 114.968 310.931 116.664V129H306.131ZM342.282 129.576C340.01 129.576 338.026 129.032 336.33 127.944C334.666 126.856 333.37 125.368 332.442 123.48C331.546 121.592 331.098 119.464 331.098 117.096C331.098 114.728 331.546 112.6 332.442 110.712C333.37 108.824 334.698 107.336 336.426 106.248C338.186 105.16 340.282 104.616 342.714 104.616C344.826 104.616 346.586 105.048 347.994 105.912C349.402 106.776 350.49 107.752 351.258 108.84V95.4H356.058V129H352.026L351.69 124.536H351.498C350.826 125.656 350.026 126.584 349.098 127.32C348.17 128.056 347.13 128.616 345.978 129C344.858 129.384 343.626 129.576 342.282 129.576ZM343.578 125.496C345.114 125.496 346.458 125.144 347.61 124.44C348.762 123.736 349.642 122.76 350.25 121.512C350.89 120.232 351.21 118.76 351.21 117.096C351.21 115.4 350.89 113.928 350.25 112.68C349.642 111.432 348.762 110.456 347.61 109.752C346.458 109.048 345.098 108.696 343.53 108.696C341.994 108.696 340.65 109.048 339.498 109.752C338.378 110.456 337.498 111.448 336.858 112.728C336.25 113.976 335.946 115.432 335.946 117.096C335.946 118.76 336.25 120.232 336.858 121.512C337.498 122.76 338.378 123.736 339.498 124.44C340.65 125.144 342.01 125.496 343.578 125.496ZM383.622 129V100.824L378.15 102.072V98.568L385.398 95.4H388.518V129H383.622Z" />
                            </mask>
                            <path d="M228.465 129V95.4H239.841C242.497 95.4 244.673 95.848 246.369 96.744C248.065 97.64 249.313 98.84 250.113 100.344C250.945 101.816 251.361 103.496 251.361 105.384C251.361 107.176 250.945 108.84 250.113 110.376C249.313 111.88 248.049 113.096 246.321 114.024C244.593 114.92 242.385 115.368 239.697 115.368H233.265V129H228.465ZM246.129 129L238.881 114.072H244.161L251.697 129H246.129ZM233.265 111.72H239.505C241.905 111.72 243.649 111.144 244.737 109.992C245.857 108.808 246.417 107.304 246.417 105.48C246.417 103.624 245.873 102.152 244.785 101.064C243.697 99.976 241.937 99.432 239.505 99.432H233.265V111.72ZM265.285 129.576C263.045 129.576 261.013 129.064 259.189 128.04C257.397 126.984 255.973 125.528 254.917 123.672C253.861 121.784 253.333 119.592 253.333 117.096C253.333 114.6 253.861 112.424 254.917 110.568C256.005 108.68 257.445 107.224 259.237 106.2C261.061 105.144 263.109 104.616 265.381 104.616C267.653 104.616 269.685 105.144 271.477 106.2C273.301 107.224 274.725 108.68 275.749 110.568C276.805 112.424 277.333 114.6 277.333 117.096C277.333 119.592 276.805 121.784 275.749 123.672C274.693 125.528 273.253 126.984 271.429 128.04C269.605 129.064 267.557 129.576 265.285 129.576ZM265.285 125.736C266.565 125.736 267.733 125.416 268.789 124.776C269.877 124.136 270.757 123.192 271.429 121.944C272.101 120.664 272.437 119.048 272.437 117.096C272.437 115.144 272.101 113.528 271.429 112.248C270.789 110.968 269.925 110.024 268.837 109.416C267.781 108.776 266.629 108.456 265.381 108.456C264.133 108.456 262.965 108.776 261.877 109.416C260.789 110.024 259.909 110.968 259.237 112.248C258.565 113.528 258.229 115.144 258.229 117.096C258.229 119.048 258.565 120.664 259.237 121.944C259.909 123.192 260.773 124.136 261.829 124.776C262.917 125.416 264.069 125.736 265.285 125.736ZM289.371 129.576C287.515 129.576 285.899 129.192 284.523 128.424C283.147 127.624 282.075 126.44 281.307 124.872C280.571 123.304 280.203 121.32 280.203 118.92V105.192H285.003V118.44C285.003 120.744 285.483 122.504 286.443 123.72C287.435 124.904 288.875 125.496 290.763 125.496C292.075 125.496 293.227 125.192 294.219 124.584C295.211 123.944 295.995 123.032 296.571 121.848C297.179 120.632 297.483 119.192 297.483 117.528V105.192H302.283V129H298.107L297.675 125.256H297.483C296.683 126.536 295.611 127.576 294.267 128.376C292.923 129.176 291.291 129.576 289.371 129.576ZM306.131 129V105.192H310.307L310.739 108.984H310.931C311.731 107.64 312.803 106.584 314.147 105.816C315.491 105.016 317.123 104.616 319.043 104.616C320.899 104.616 322.515 105.016 323.891 105.816C325.267 106.584 326.323 107.752 327.059 109.32C327.827 110.888 328.211 112.872 328.211 115.272V129H323.411V115.752C323.411 113.448 322.915 111.704 321.923 110.52C320.963 109.304 319.523 108.696 317.603 108.696C316.323 108.696 315.171 109.016 314.147 109.656C313.155 110.264 312.371 111.16 311.795 112.344C311.219 113.528 310.931 114.968 310.931 116.664V129H306.131ZM342.282 129.576C340.01 129.576 338.026 129.032 336.33 127.944C334.666 126.856 333.37 125.368 332.442 123.48C331.546 121.592 331.098 119.464 331.098 117.096C331.098 114.728 331.546 112.6 332.442 110.712C333.37 108.824 334.698 107.336 336.426 106.248C338.186 105.16 340.282 104.616 342.714 104.616C344.826 104.616 346.586 105.048 347.994 105.912C349.402 106.776 350.49 107.752 351.258 108.84V95.4H356.058V129H352.026L351.69 124.536H351.498C350.826 125.656 350.026 126.584 349.098 127.32C348.17 128.056 347.13 128.616 345.978 129C344.858 129.384 343.626 129.576 342.282 129.576ZM343.578 125.496C345.114 125.496 346.458 125.144 347.61 124.44C348.762 123.736 349.642 122.76 350.25 121.512C350.89 120.232 351.21 118.76 351.21 117.096C351.21 115.4 350.89 113.928 350.25 112.68C349.642 111.432 348.762 110.456 347.61 109.752C346.458 109.048 345.098 108.696 343.53 108.696C341.994 108.696 340.65 109.048 339.498 109.752C338.378 110.456 337.498 111.448 336.858 112.728C336.25 113.976 335.946 115.432 335.946 117.096C335.946 118.76 336.25 120.232 336.858 121.512C337.498 122.76 338.378 123.736 339.498 124.44C340.65 125.144 342.01 125.496 343.578 125.496ZM383.622 129V100.824L378.15 102.072V98.568L385.398 95.4H388.518V129H383.622Z" fill="white" />
                            <path d="M228.465 129H220.465V137H228.465V129ZM228.465 95.4V87.4H220.465V95.4H228.465ZM250.113 100.344L243.05 104.101L243.098 104.191L243.148 104.28L250.113 100.344ZM250.113 110.376L243.078 106.566L243.064 106.592L243.05 106.619L250.113 110.376ZM246.321 114.024L250.003 121.126L250.055 121.099L250.106 121.072L246.321 114.024ZM233.265 115.368V107.368H225.265V115.368H233.265ZM233.265 129V137H241.265V129H233.265ZM246.129 129L238.932 132.494L241.12 137H246.129V129ZM238.881 114.072V106.072H226.103L231.684 117.566L238.881 114.072ZM244.161 114.072L251.302 110.467L249.084 106.072H244.161V114.072ZM251.697 129V137H264.697L258.838 125.395L251.697 129ZM233.265 111.72H225.265V119.72H233.265V111.72ZM244.737 109.992L238.925 104.494L238.921 104.499L244.737 109.992ZM244.785 101.064L239.128 106.721L239.128 106.721L244.785 101.064ZM233.265 99.432V91.432H225.265V99.432H233.265ZM236.465 129V95.4H220.465V129H236.465ZM228.465 103.4H239.841V87.4H228.465V103.4ZM239.841 103.4C241.669 103.4 242.444 103.719 242.632 103.818L250.106 89.6705C246.901 87.9774 243.325 87.4 239.841 87.4V103.4ZM242.632 103.818C242.889 103.954 243.001 104.053 243.032 104.083C243.049 104.099 243.053 104.105 243.051 104.103C243.05 104.101 243.049 104.099 243.05 104.101L257.176 96.5871C255.531 93.4957 253.032 91.2167 250.106 89.6705L242.632 103.818ZM243.148 104.28C243.225 104.416 243.361 104.711 243.361 105.384H259.361C259.361 102.281 258.664 99.2158 257.077 96.4075L243.148 104.28ZM243.361 105.384C243.361 105.881 243.26 106.231 243.078 106.566L257.147 114.186C258.63 111.449 259.361 108.471 259.361 105.384H243.361ZM243.05 106.619C243.058 106.604 243.06 106.61 243.018 106.651C242.97 106.697 242.832 106.817 242.536 106.976L250.106 121.072C253.011 119.512 255.525 117.237 257.176 114.133L243.05 106.619ZM242.638 106.922C242.398 107.047 241.565 107.368 239.697 107.368V123.368C243.204 123.368 246.788 122.793 250.003 121.126L242.638 106.922ZM239.697 107.368H233.265V123.368H239.697V107.368ZM225.265 115.368V129H241.265V115.368H225.265ZM233.265 121H228.465V137H233.265V121ZM253.325 125.506L246.077 110.578L231.684 117.566L238.932 132.494L253.325 125.506ZM238.881 122.072H244.161V106.072H238.881V122.072ZM237.019 117.677L244.555 132.605L258.838 125.395L251.302 110.467L237.019 117.677ZM251.697 121H246.129V137H251.697V121ZM233.265 119.72H239.505V103.72H233.265V119.72ZM239.505 119.72C242.981 119.72 247.324 118.903 250.553 115.485L238.921 104.499C239.159 104.247 239.407 104.056 239.631 103.919C239.851 103.785 240.021 103.719 240.104 103.692C240.246 103.645 240.099 103.72 239.505 103.72V119.72ZM250.548 115.49C253.245 112.639 254.417 109.085 254.417 105.48H238.417C238.417 105.568 238.405 105.439 238.5 105.184C238.6 104.915 238.759 104.67 238.925 104.494L250.548 115.49ZM254.417 105.48C254.417 101.97 253.331 98.2966 250.442 95.4071L239.128 106.721C238.839 106.432 238.625 106.082 238.505 105.757C238.395 105.46 238.417 105.329 238.417 105.48H254.417ZM250.442 95.4071C247.181 92.1464 242.867 91.432 239.505 91.432V107.432C239.819 107.432 240.037 107.45 240.173 107.467C240.31 107.485 240.339 107.5 240.286 107.483C240.167 107.446 239.669 107.262 239.128 106.721L250.442 95.4071ZM239.505 91.432H233.265V107.432H239.505V91.432ZM225.265 99.432V111.72H241.265V99.432H225.265ZM259.189 128.04L255.127 134.932L255.199 134.975L255.273 135.016L259.189 128.04ZM254.917 123.672L247.935 127.577L247.949 127.603L247.964 127.628L254.917 123.672ZM254.917 110.568L247.985 106.574L247.974 106.593L247.964 106.612L254.917 110.568ZM259.237 106.2L263.206 113.146L263.226 113.135L263.245 113.123L259.237 106.2ZM271.477 106.2L267.415 113.092L267.487 113.135L267.561 113.176L271.477 106.2ZM275.749 110.568L268.717 114.382L268.755 114.454L268.796 114.524L275.749 110.568ZM275.749 123.672L282.702 127.628L282.717 127.603L282.731 127.577L275.749 123.672ZM271.429 128.04L275.345 135.016L275.391 134.99L275.437 134.963L271.429 128.04ZM268.789 124.776L264.733 117.881L264.687 117.907L264.642 117.934L268.789 124.776ZM271.429 121.944L278.473 125.737L278.492 125.7L278.512 125.663L271.429 121.944ZM271.429 112.248L264.273 115.826L264.309 115.897L264.346 115.967L271.429 112.248ZM268.837 109.416L264.69 116.258L264.811 116.331L264.934 116.4L268.837 109.416ZM261.877 109.416L265.779 116.4L265.857 116.356L265.933 116.311L261.877 109.416ZM259.237 112.248L266.32 115.967L259.237 112.248ZM259.237 121.944L252.154 125.663L252.173 125.7L252.193 125.737L259.237 121.944ZM261.829 124.776L257.682 131.618L257.727 131.645L257.773 131.671L261.829 124.776ZM265.285 121.576C264.316 121.576 263.648 121.369 263.105 121.064L255.273 135.016C258.377 136.759 261.774 137.576 265.285 137.576V121.576ZM263.25 121.148C262.695 120.821 262.254 120.391 261.87 119.716L247.964 127.628C249.691 130.665 252.098 133.147 255.127 134.932L263.25 121.148ZM261.899 119.767C261.607 119.245 261.333 118.437 261.333 117.096H245.333C245.333 120.747 246.115 124.323 247.935 127.577L261.899 119.767ZM261.333 117.096C261.333 115.751 261.608 114.985 261.87 114.524L247.964 106.612C246.114 109.863 245.333 113.449 245.333 117.096H261.333ZM261.848 114.562C262.269 113.832 262.715 113.426 263.206 113.146L255.268 99.2541C252.175 101.022 249.741 103.528 247.985 106.574L261.848 114.562ZM263.245 113.123C263.756 112.827 264.403 112.616 265.381 112.616V96.616C261.815 96.616 258.365 97.4606 255.229 99.2766L263.245 113.123ZM265.381 112.616C266.36 112.616 266.966 112.828 267.415 113.092L275.538 99.3077C272.404 97.4604 268.945 96.616 265.381 96.616V112.616ZM267.561 113.176C268.032 113.44 268.392 113.783 268.717 114.382L282.781 106.754C281.058 103.577 278.57 101.008 275.393 99.2241L267.561 113.176ZM268.796 114.524C269.058 114.985 269.333 115.751 269.333 117.096H285.333C285.333 113.449 284.552 109.863 282.702 106.612L268.796 114.524ZM269.333 117.096C269.333 118.437 269.059 119.245 268.767 119.767L282.731 127.577C284.551 124.323 285.333 120.747 285.333 117.096H269.333ZM268.796 119.716C268.431 120.356 268 120.781 267.421 121.117L275.437 134.963C278.505 133.187 280.955 130.7 282.702 127.628L268.796 119.716ZM267.513 121.064C266.986 121.36 266.307 121.576 265.285 121.576V137.576C268.807 137.576 272.223 136.768 275.345 135.016L267.513 121.064ZM265.285 133.736C267.971 133.736 270.582 133.044 272.935 131.618L264.642 117.934C264.736 117.878 264.862 117.82 265.007 117.78C265.15 117.741 265.251 117.736 265.285 117.736V133.736ZM272.845 131.671C275.344 130.202 277.195 128.11 278.473 125.737L264.385 118.151C264.342 118.231 264.343 118.208 264.413 118.133C264.487 118.054 264.597 117.96 264.733 117.881L272.845 131.671ZM278.512 125.663C279.96 122.905 280.437 119.91 280.437 117.096H264.437C264.437 118.186 264.242 118.423 264.346 118.225L278.512 125.663ZM280.437 117.096C280.437 114.282 279.96 111.287 278.512 108.529L264.346 115.967C264.242 115.769 264.437 116.006 264.437 117.096H280.437ZM278.584 108.67C277.336 106.174 275.429 103.935 272.739 102.432L264.934 116.4C264.712 116.275 264.529 116.123 264.399 115.981C264.276 115.846 264.246 115.771 264.273 115.826L278.584 108.67ZM272.983 102.574C270.663 101.168 268.074 100.456 265.381 100.456V116.456C265.313 116.456 265.191 116.446 265.04 116.404C264.888 116.362 264.767 116.304 264.69 116.258L272.983 102.574ZM265.381 100.456C262.689 100.456 260.123 101.166 257.821 102.521L265.933 116.311C265.894 116.334 265.808 116.377 265.683 116.412C265.557 116.446 265.449 116.456 265.381 116.456V100.456ZM257.974 102.432C255.326 103.912 253.429 106.1 252.154 108.529L266.32 115.967C266.364 115.883 266.353 115.927 266.253 116.035C266.146 116.149 265.986 116.284 265.779 116.4L257.974 102.432ZM252.154 108.529C250.706 111.287 250.229 114.282 250.229 117.096H266.229C266.229 116.006 266.424 115.769 266.32 115.967L252.154 108.529ZM250.229 117.096C250.229 119.91 250.706 122.905 252.154 125.663L266.32 118.225C266.424 118.423 266.229 118.186 266.229 117.096H250.229ZM252.193 125.737C253.44 128.052 255.235 130.134 257.682 131.618L265.975 117.934C266.121 118.023 266.227 118.118 266.29 118.187C266.349 118.251 266.337 118.256 266.281 118.151L252.193 125.737ZM257.773 131.671C260.041 133.006 262.587 133.736 265.285 133.736V117.736C265.388 117.736 265.517 117.751 265.65 117.788C265.781 117.824 265.862 117.867 265.885 117.881L257.773 131.671ZM284.523 128.424L280.502 135.34L280.563 135.375L280.625 135.41L284.523 128.424ZM281.307 124.872L274.066 128.271L274.094 128.331L274.123 128.391L281.307 124.872ZM280.203 105.192V97.192H272.203V105.192H280.203ZM285.003 105.192H293.003V97.192H285.003V105.192ZM286.443 123.72L280.164 128.677L280.237 128.769L280.311 128.858L286.443 123.72ZM294.219 124.584L298.4 131.405L298.479 131.356L298.556 131.306L294.219 124.584ZM296.571 121.848L289.416 118.27L289.397 118.309L289.378 118.348L296.571 121.848ZM297.483 105.192V97.192H289.483V105.192H297.483ZM302.283 105.192H310.283V97.192H302.283V105.192ZM302.283 129V137H310.283V129H302.283ZM298.107 129L290.16 129.917L290.977 137H298.107V129ZM297.675 125.256L305.623 124.339L304.805 117.256H297.675V125.256ZM297.483 125.256V117.256H293.049L290.699 121.016L297.483 125.256ZM294.267 128.376L298.359 135.25L294.267 128.376ZM289.371 121.576C288.995 121.576 288.753 121.537 288.617 121.505C288.487 121.474 288.433 121.445 288.422 121.438L280.625 135.41C283.388 136.952 286.394 137.576 289.371 137.576V121.576ZM288.544 121.508C288.553 121.513 288.568 121.523 288.586 121.537C288.603 121.551 288.614 121.562 288.618 121.567C288.621 121.571 288.612 121.56 288.591 121.529C288.57 121.498 288.535 121.442 288.492 121.353L274.123 128.391C275.516 131.236 277.627 133.669 280.502 135.34L288.544 121.508ZM288.549 121.473C288.466 121.296 288.203 120.57 288.203 118.92H272.203C272.203 122.07 272.677 125.312 274.066 128.271L288.549 121.473ZM288.203 118.92V105.192H272.203V118.92H288.203ZM280.203 113.192H285.003V97.192H280.203V113.192ZM277.003 105.192V118.44H293.003V105.192H277.003ZM277.003 118.44C277.003 121.702 277.661 125.507 280.164 128.677L292.722 118.763C293.017 119.135 293.088 119.407 293.082 119.383C293.078 119.369 293.057 119.288 293.038 119.128C293.019 118.967 293.003 118.741 293.003 118.44H277.003ZM280.311 128.858C283.158 132.256 287.085 133.496 290.763 133.496V117.496C290.647 117.496 290.883 117.477 291.309 117.653C291.777 117.845 292.233 118.173 292.576 118.582L280.311 128.858ZM290.763 133.496C293.358 133.496 295.995 132.879 298.4 131.405L290.039 117.763C290.224 117.65 290.411 117.575 290.57 117.533C290.724 117.492 290.799 117.496 290.763 117.496V133.496ZM298.556 131.306C300.915 129.785 302.625 127.691 303.765 125.348L289.378 118.348C289.362 118.38 289.389 118.317 289.485 118.205C289.585 118.089 289.72 117.966 289.882 117.862L298.556 131.306ZM303.727 125.426C305.001 122.878 305.483 120.16 305.483 117.528H289.483C289.483 118.224 289.358 118.386 289.416 118.27L303.727 125.426ZM305.483 117.528V105.192H289.483V117.528H305.483ZM297.483 113.192H302.283V97.192H297.483V113.192ZM294.283 105.192V129H310.283V105.192H294.283ZM302.283 121H298.107V137H302.283V121ZM306.055 128.083L305.623 124.339L289.728 126.173L290.16 129.917L306.055 128.083ZM297.675 117.256H297.483V133.256H297.675V117.256ZM290.699 121.016C290.599 121.176 290.466 121.329 290.176 121.502L298.359 135.25C300.757 133.823 302.768 131.896 304.267 129.496L290.699 121.016ZM290.176 121.502C290.233 121.467 290.235 121.481 290.131 121.506C290.019 121.533 289.779 121.576 289.371 121.576V137.576C292.405 137.576 295.524 136.938 298.359 135.25L290.176 121.502ZM306.131 129H298.131V137H306.131V129ZM306.131 105.192V97.192H298.131V105.192H306.131ZM310.307 105.192L318.256 104.286L317.447 97.192H310.307V105.192ZM310.739 108.984L302.79 109.89L303.599 116.984H310.739V108.984ZM310.931 108.984V116.984H315.479L317.805 113.076L310.931 108.984ZM314.147 105.816L318.116 112.762L318.178 112.727L318.239 112.69L314.147 105.816ZM323.891 105.816L319.87 112.732L319.931 112.767L319.992 112.802L323.891 105.816ZM327.059 109.32L319.817 112.719L319.845 112.779L319.874 112.839L327.059 109.32ZM328.211 129V137H336.211V129H328.211ZM323.411 129H315.411V137H323.411V129ZM321.923 110.52L315.644 115.477L315.716 115.569L315.791 115.658L321.923 110.52ZM314.147 109.656L318.327 116.477L318.357 116.459L318.387 116.44L314.147 109.656ZM310.931 129V137H318.931V129H310.931ZM314.131 129V105.192H298.131V129H314.131ZM306.131 113.192H310.307V97.192H306.131V113.192ZM302.358 106.098L302.79 109.89L318.688 108.078L318.256 104.286L302.358 106.098ZM310.739 116.984H310.931V100.984H310.739V116.984ZM317.805 113.076C317.907 112.905 317.983 112.838 318.116 112.762L310.178 98.8701C307.622 100.33 305.555 102.375 304.057 104.892L317.805 113.076ZM318.239 112.69C318.181 112.725 318.18 112.711 318.283 112.686C318.395 112.659 318.635 112.616 319.043 112.616V96.616C316.009 96.616 312.89 97.2541 310.055 98.9417L318.239 112.69ZM319.043 112.616C319.396 112.616 319.613 112.654 319.725 112.682C319.83 112.708 319.867 112.731 319.87 112.732L327.912 98.8999C325.125 97.2796 322.074 96.616 319.043 96.616V112.616ZM319.992 112.802C319.961 112.784 319.922 112.759 319.88 112.726C319.839 112.693 319.805 112.66 319.781 112.633C319.757 112.606 319.749 112.593 319.755 112.602C319.761 112.612 319.784 112.648 319.817 112.719L334.301 105.921C332.927 102.995 330.773 100.496 327.79 98.8304L319.992 112.802ZM319.874 112.839C319.944 112.981 320.211 113.66 320.211 115.272H336.211C336.211 112.084 335.71 108.795 334.243 105.801L319.874 112.839ZM320.211 115.272V129H336.211V115.272H320.211ZM328.211 121H323.411V137H328.211V121ZM331.411 129V115.752H315.411V129H331.411ZM331.411 115.752C331.411 112.461 330.724 108.567 328.055 105.382L315.791 115.658C315.626 115.461 315.514 115.278 315.442 115.137C315.372 114.999 315.347 114.913 315.344 114.904C315.342 114.897 315.36 114.957 315.377 115.102C315.395 115.247 315.411 115.46 315.411 115.752H331.411ZM328.202 105.563C325.365 101.97 321.326 100.696 317.603 100.696V116.696C317.731 116.696 317.473 116.717 317.011 116.522C316.501 116.306 316.007 115.937 315.644 115.477L328.202 105.563ZM317.603 100.696C314.918 100.696 312.28 101.389 309.907 102.872L318.387 116.44C318.254 116.523 318.092 116.596 317.92 116.644C317.751 116.691 317.636 116.696 317.603 116.696V100.696ZM309.966 102.835C307.508 104.342 305.754 106.474 304.601 108.844L318.989 115.844C318.998 115.824 318.958 115.912 318.836 116.052C318.709 116.197 318.536 116.349 318.327 116.477L309.966 102.835ZM304.601 108.844C303.365 111.386 302.931 114.093 302.931 116.664H318.931C318.931 115.843 319.073 115.67 318.989 115.844L304.601 108.844ZM302.931 116.664V129H318.931V116.664H302.931ZM310.931 121H306.131V137H310.931V121ZM336.33 127.944L331.952 134.64L331.982 134.659L332.011 134.678L336.33 127.944ZM332.442 123.48L325.215 126.91L325.239 126.96L325.263 127.009L332.442 123.48ZM332.442 110.712L325.263 107.183L325.239 107.232L325.215 107.282L332.442 110.712ZM336.426 106.248L332.22 99.4432L332.192 99.4606L332.164 99.4781L336.426 106.248ZM347.994 105.912L352.179 99.0934V99.0934L347.994 105.912ZM351.258 108.84L344.723 113.453L359.258 134.046V108.84H351.258ZM351.258 95.4V87.4H343.258V95.4H351.258ZM356.058 95.4H364.058V87.4H356.058V95.4ZM356.058 129V137H364.058V129H356.058ZM352.026 129L344.049 129.6L344.606 137H352.026V129ZM351.69 124.536L359.668 123.936L359.111 116.536H351.69V124.536ZM351.498 124.536V116.536H346.969L344.638 120.42L351.498 124.536ZM349.098 127.32L344.127 121.052V121.052L349.098 127.32ZM345.978 129L343.449 121.411L343.416 121.421L343.384 121.432L345.978 129ZM350.25 121.512L343.095 117.934L343.077 117.971L343.059 118.008L350.25 121.512ZM350.25 112.68L343.059 116.184L343.094 116.258L343.132 116.331L350.25 112.68ZM347.61 109.752L351.782 102.926V102.926L347.61 109.752ZM339.498 109.752L335.327 102.926L335.284 102.952L335.241 102.979L339.498 109.752ZM336.858 112.728L329.703 109.15L329.685 109.187L329.667 109.224L336.858 112.728ZM336.858 121.512L329.632 124.944L329.684 125.054L329.74 125.163L336.858 121.512ZM339.498 124.44L335.241 131.213L335.284 131.24L335.327 131.266L339.498 124.44ZM342.282 121.576C341.341 121.576 340.898 121.369 340.65 121.21L332.011 134.678C335.155 136.695 338.68 137.576 342.282 137.576V121.576ZM340.708 121.248C340.316 120.992 339.955 120.629 339.622 119.951L325.263 127.009C326.786 130.107 329.017 132.72 331.952 134.64L340.708 121.248ZM339.67 120.05C339.346 119.368 339.098 118.436 339.098 117.096H323.098C323.098 120.492 323.747 123.816 325.215 126.91L339.67 120.05ZM339.098 117.096C339.098 115.756 339.346 114.824 339.67 114.142L325.215 107.282C323.747 110.376 323.098 113.7 323.098 117.096H339.098ZM339.622 114.241C339.917 113.64 340.254 113.292 340.689 113.018L332.164 99.4781C329.143 101.38 326.824 104.008 325.263 107.183L339.622 114.241ZM340.633 113.053C340.922 112.874 341.504 112.616 342.714 112.616V96.616C339.061 96.616 335.451 97.4457 332.22 99.4432L340.633 113.053ZM342.714 112.616C343.755 112.616 343.967 112.827 343.81 112.731L352.179 99.0934C349.206 97.2692 345.898 96.616 342.714 96.616V112.616ZM343.81 112.731C344.509 113.159 344.712 113.438 344.723 113.453L357.794 104.227C356.269 102.066 354.296 100.393 352.179 99.0934L343.81 112.731ZM359.258 108.84V95.4H343.258V108.84H359.258ZM351.258 103.4H356.058V87.4H351.258V103.4ZM348.058 95.4V129H364.058V95.4H348.058ZM356.058 121H352.026V137H356.058V121ZM360.004 128.4L359.668 123.936L343.713 125.136L344.049 129.6L360.004 128.4ZM351.69 116.536H351.498V132.536H351.69V116.536ZM344.638 120.42C344.411 120.8 344.228 120.972 344.127 121.052L354.07 133.588C355.825 132.196 357.242 130.512 358.358 128.652L344.638 120.42ZM344.127 121.052C343.948 121.194 343.739 121.314 343.449 121.411L348.508 136.589C350.522 135.918 352.393 134.918 354.07 133.588L344.127 121.052ZM343.384 121.432C343.203 121.494 342.861 121.576 342.282 121.576V137.576C344.392 137.576 346.513 137.274 348.573 136.568L343.384 121.432ZM343.578 133.496C346.379 133.496 349.208 132.839 351.782 131.266L343.439 117.614C343.49 117.583 343.542 117.556 343.593 117.534C343.644 117.513 343.685 117.5 343.712 117.493C343.767 117.479 343.734 117.496 343.578 117.496V133.496ZM351.782 131.266C354.276 129.742 356.185 127.596 357.442 125.016L343.059 118.008C343.064 117.997 343.104 117.922 343.193 117.823C343.283 117.723 343.375 117.653 343.439 117.614L351.782 131.266ZM357.406 125.09C358.685 122.531 359.21 119.8 359.21 117.096H343.21C343.21 117.72 343.096 117.933 343.095 117.934L357.406 125.09ZM359.21 117.096C359.21 114.393 358.697 111.62 357.369 109.029L343.132 116.331C343.084 116.236 343.21 116.407 343.21 117.096H359.21ZM357.442 109.176C356.185 106.596 354.276 104.45 351.782 102.926L343.439 116.578C343.375 116.539 343.283 116.469 343.193 116.369C343.104 116.27 343.064 116.195 343.059 116.184L357.442 109.176ZM351.782 102.926C349.183 101.337 346.329 100.696 343.53 100.696V116.696C343.715 116.696 343.767 116.717 343.722 116.705C343.7 116.699 343.66 116.687 343.607 116.665C343.554 116.643 343.497 116.614 343.439 116.578L351.782 102.926ZM343.53 100.696C340.73 100.696 337.901 101.353 335.327 102.926L343.67 116.578C343.619 116.609 343.567 116.636 343.516 116.658C343.465 116.679 343.424 116.692 343.397 116.699C343.342 116.713 343.375 116.696 343.53 116.696V100.696ZM335.241 102.979C332.78 104.526 330.943 106.671 329.703 109.15L344.014 116.306C344.046 116.242 344.042 116.266 343.983 116.333C343.921 116.403 343.84 116.472 343.756 116.525L335.241 102.979ZM329.667 109.224C328.431 111.759 327.946 114.456 327.946 117.096H343.946C343.946 116.408 344.069 116.193 344.05 116.232L329.667 109.224ZM327.946 117.096C327.946 119.742 328.433 122.421 329.632 124.944L344.085 118.08C344.067 118.043 343.946 117.778 343.946 117.096H327.946ZM329.74 125.163C330.995 127.609 332.83 129.698 335.241 131.213L343.756 117.667C343.816 117.704 343.883 117.76 343.94 117.823C343.995 117.884 344.002 117.909 343.977 117.861L329.74 125.163ZM335.327 131.266C337.926 132.855 340.78 133.496 343.578 133.496V117.496C343.394 117.496 343.342 117.475 343.387 117.487C343.409 117.493 343.449 117.505 343.502 117.527C343.555 117.549 343.612 117.578 343.67 117.614L335.327 131.266ZM383.622 129H375.622V137H383.622V129ZM383.622 100.824H391.622V90.794L381.843 93.0243L383.622 100.824ZM378.15 102.072H370.15V112.102L379.929 109.872L378.15 102.072ZM378.15 98.568L374.946 91.2376L370.15 93.3339V98.568H378.15ZM385.398 95.4V87.4H383.726L382.194 88.0696L385.398 95.4ZM388.518 95.4H396.518V87.4H388.518V95.4ZM388.518 129V137H396.518V129H388.518ZM391.622 129V100.824H375.622V129H391.622ZM381.843 93.0243L376.371 94.2723L379.929 109.872L385.401 108.624L381.843 93.0243ZM386.15 102.072V98.568H370.15V102.072H386.15ZM381.354 105.898L388.602 102.73L382.194 88.0696L374.946 91.2376L381.354 105.898ZM385.398 103.4H388.518V87.4H385.398V103.4ZM380.518 95.4V129H396.518V95.4H380.518ZM388.518 121H383.622V137H388.518V121Z" fill="#CF5BFF" mask="url(#path-2-outside-1_12180_17983)" />
                            <defs>
                                <filter id="filter0_f_12180_17983" x="0" y="-47" width="617" height="320" filterUnits="userSpaceOnUse" colorInterpolationFilters="sRGB">
                                    <feFlood floodOpacity="0" result="BackgroundImageFix" />
                                    <feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape" />
                                    <feGaussianBlur stdDeviation="57" result="effect1_foregroundBlur_12180_17983" />
                                </filter>
                            </defs>
                        </svg>
                        <div className="game_round-bg  h-[303px] flex flex-col justify-between items-center pt-24 -mt-28">
                            <p className="text-2xl text-center text-white font-bold max-w-[477px] truncate">{question || 'No question selected'}</p>
                        </div>
                    </div>


                    <div className='basis-1/2'>
                        <div className="">
                            <div>
                                <h2 className="text-xl font-medium mb-6 text-white bg-[#4C1961] w-[282px] py-2 px-[34px] rounded-[15px]">Players game time log</h2>
                                {/* <ul>
                                    {players.map((player) => (
                                        <li key={player.id}>
                                            {player.name}
                                        </li>
                                    ))}
                                </ul> */}
                                <ul className='w-full space-y-4'>
                                    {sortedAnswers.map((answer, index) => (
                                        <li
                                            key={index}
                                            className={`flex-grow flex justify-between items-center  bg-opacity-[10%] py-[20px] px-[27px] rounded-[20px] text-lg text-white text-left hover:border hover:from-wise-green-bg w-full ${index === 0 ? 'bg-[#01AE5333] border from-wise-green-bg' : 'bg-[#F26DE8]'}`}
                                        >
                                            <div className='flex items-center gap-4'>
                                                <p className={`w-[38px] h-[38px] rounded-full text-white flex items-center justify-center  ${index === 0 ? 'bg-[#006839]' : 'bg-[#262646]'}`}>{index + 1}</p>
                                                <p> {
                                                    // eslint-disable-next-line @typescript-eslint/ban-ts-comment
                                                    //@ts-ignore
                                                    answer.playerName}</p>
                                            </div>
                                            <div className='text-sm'>Time: {
                                                // eslint-disable-next-line @typescript-eslint/ban-ts-comment
                                                //@ts-ignore
                                                formatTime(answer.time)

                                            }

                                            </div>
                                            <div className='text-sm'>
                                                {/* // // eslint-disable-next-line @typescript-eslint/ban-ts-comment
                                                // //@ts-ignore
                                                // index === 0 ? '00:00:00.000' : calculateTimeDifference(answers[0].time, answer.time)} */}

                                                {
                                                    // eslint-disable-next-line @typescript-eslint/ban-ts-comment
                                                    //@ts-ignore
                                                    answer.time - answers[0].time}ms</div>
                                        </li>
                                    ))}
                                </ul>
                            </div>

                            {/* <div>
                                <h2 className="text-2xl font-semibold mb-2">Answers:</h2>
                                <div className="flex justify-between items-center mb-2">
                                    <button
                                        onClick={toggleSortOrder}
                                        className="flex items-center px-2 py-1 bg-gray-200 rounded hover:bg-gray-300"
                                        aria-label={`Sort by time difference ${sortOrder === 'asc' ? 'ascending' : 'descending'}`}
                                    >
                                        Sort by Time <ArrowUpDown className="ml-1 h-4 w-4" />
                                    </button>
                                    <button
                                        onClick={exportResults}
                                        className="flex items-center px-2 py-1 bg-green-500 text-white rounded hover:bg-green-600"
                                        aria-label="Export results to CSV"
                                    >
                                        Export <Download className="ml-1 h-4 w-4" />
                                    </button>
                                </div>
                                <ul>
                                    {sortedAnswers.map((answer, index) => (
                                        <li
                                            key={index}
                                            className={`mb-2 p-2 rounded ${index === 0 ? 'bg-green-100' : 'bg-gray-100'}`}
                                        >
                                            <div><strong>{answer.playerName}</strong></div>
                                            <div>Response time: {formatTime(answer.time)}</div>
                                            <div>Time difference: {index === 0 ? '00:00:00.000' : calculateTimeDifference(answers[0].time, answer.time)}</div>
                                        </li>
                                    ))}
                                </ul>
                            </div> */}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    );
}